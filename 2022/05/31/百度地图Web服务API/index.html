<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf8" />
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />
    <title>
      
        百度地图Web服务api文档 | 思想放牧之地
      
    </title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="/images/apple-touch-icon.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="32x32"
            href="/images/favicon-32x32.png" />
    
    
      <link rel="icon"
            type="image/png"
            sizes="16x16"
            href="/images/favicon-16x16.png" />
    
    
      <link rel="mask-icon"
            href="/images/logo.svg"
            color="" />
    
    
    
      
  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/normal.ttf);
        font-weight: normal;
    }
  </style>

  <style>
    @font-face {
        font-family:sourceHanSerif;
        src: url(/font/bold.ttf);
        font-weight: bold;
    }
  </style>


    
    <link rel="stylesheet"
          type="text/css"
          href='/css/layout.css' />
    
    
  <link rel="stylesheet" type="text/css" href="/css/post.css"/>
  

  <meta name="generator" content="Hexo 7.3.0"></head>
  <body>
    
      <div id="search-mask" style="display:none">
  <div class="search-main" id="search-main">
    <div class="search__head">
      <div class="search-form">
        <svg t="1706347533072"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="7828"
             width="20"
             height="20">
          <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
          </path>
        </svg>
        <input id="search-input" placeholder="搜索文章">
        <svg t="1706361500528"
             id="search-clear"
             class="icon"
             viewBox="0 0 1024 1024"
             version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="4351"
             width="20"
             height="20">
          <path d="M512 562.688l-264.2944 264.2944-50.688-50.688L461.312 512 197.0176 247.7056l50.688-50.688L512 461.312l264.2944-264.2944 50.688 50.688L562.688 512l264.2944 264.2944-50.688 50.688L512 562.688z" fill="#00" p-id="4352">
          </path>
        </svg>
      </div>
    </div>
    <div class="search__body" id="search-result"></div>
    <div class="search__foot"></div>
  </div>
</div>

    
    
    <div class=head>
      <div class="nav">
        <a href='/' class="nav-logo">
          <img alt="logo" height="60px" width="60px" src="/images/logo.svg" />
        </a>
        <input id="navBtn" type="checkbox" />
        <div class="nav-right">
          
            <div class="search-outer">
  <div class="search" id="search-btn">
    <svg t="1706347533072"
         class="icon"
         viewBox="0 0 1024 1024"
         version="1.1"
         xmlns="http://www.w3.org/2000/svg"
         p-id="7828"
         width="20"
         height="20">
      <path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829">
      </path>
    </svg>
    <span>搜索</span>
    <span class="search-shortcut-key">Ctrl K</span>
  </div>
</div>

          
          <div class="nav-menu">
            
              
                <a class="nav-menu-item" href="/AI">AI大模型</a>
              
                <a class="nav-menu-item" href="/photograph">拍摄摄影</a>
              
                <a class="nav-menu-item" href="/live">生活随记</a>
              
            
            <a class="nav-menu-item" href='/cv/'>简历</a>
          </div>
        </div>
        <label class="nav-btn" for="navBtn"></label>
      </div>
    </div>
    <div class="body">
      
  <article class="post-content">
    <div class="post-inner">
      <div class="post-content__head">
        <div class="post-title">百度地图Web服务api文档</div>
        <div class="post-info">
          
  <a href="/tags/%E7%99%BE%E5%BA%A6/" class="post-tag">#百度</a><a href="/tags/Web%E6%9C%8D%E5%8A%A1API/" class="post-tag">#Web服务API</a>


          <span class="post-date">2022-05-31</span>
        </div>
      </div>
      
      <div class="post-content__body">
        
          <div class="post-gallery">
            
          </div>
        
        <h1 id="web服务api">Web服务API</h1>
<blockquote>
<p>百度地图Web服务API为开发者提供http/https接口，即开发者通过http/https形式发起检索请求，获取返回json或xml格式的检索数据。用户可以基于此开发JavaScript、C#、C++、Java等语言的地图应用。</p>
</blockquote>
<h2 id="核心服务简介">核心服务简介</h2>
<ul>
<li>地点检索服务</li>
<li>地点输入提示服务</li>
<li>正/逆地理编码服务</li>
<li>路线规划服务</li>
<li>批量算路服务</li>
<li>IP定位服务</li>
<li>鹰眼轨迹服务</li>
<li>轻量级轨迹服务</li>
<li>时区服务</li>
<li>推荐上车点服务</li>
<li>坐标转换服务</li>
<li>地图调起服务</li>
<li>静态图服务</li>
<li>全景静态图服务</li>
</ul>
<hr />
<h2 id="获取密钥">获取密钥</h2>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2klwpnkr1j21h10grmyf.jpg"
alt="image-20220525135433526" />
<figcaption aria-hidden="true">image-20220525135433526</figcaption>
</figure>
<p>访问应用（AK）： NwrFdXX7d9ulyeUvuvrRL1pRwHEHl7qU 浏览器端</p>
<p>​ vVo0GpUwrXGIyq7Xpv6U7Bui5dNGDjaL 服务端</p>
<p>​ C3mLyfNmVlzGD4lZEpsMK0GhuxDPmQKB js API</p>
<h2 id="地点检索">地点检索</h2>
<blockquote>
<p>地点检索服务</p>
<p>地点检索服务（又名Place API）是一类Web API接口服务；
服务提供多种场景的地点（POI）检索功能，包括城市检索、圆形区域检索、矩形区域检索。开发者可通过接口获取地点（POI）基础或详细地理信息。
<strong>注意</strong>：地点检索服务适用于【XX大厦】、【XX小区】等POI地点名称的检索，若需要检索结构化地址，如【北京市海淀区上地十街十号】，则推荐使用<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-geocoding">地理编码</a>服务。</p>
</blockquote>
<h3 id="功能介绍">1、功能介绍</h3>
<h4 id="行政区划区域检索">行政区划区域检索</h4>
<p>开发者可通过该功能，检索某一行政区划内（目前最细到城市级别）的地点信息。</p>
<h4 id="圆形区域检索">圆形区域检索</h4>
<p>开发者可设置圆心和半径，检索圆形区域内的地点信息（常用于周边检索场景）。</p>
<h4 id="地点详情检索">地点详情检索</h4>
<p>不同于其他三种检索功能。地点详情检索针对指定POI，检索其相关的详情信息。开发者可以通过三种区域检索（或其他服务）功能，<strong>获取POI
id</strong>。使用“地点详情检索”功能，<strong>传入id</strong>，即可检索POI详情信息，如评分、营业时间等（不同类型POI对应不同类别详情数据）。</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kmrxy473j20bk06yt94.jpg"
alt="place4.png" />
<figcaption aria-hidden="true">place4.png</figcaption>
</figure>
<p>多边形区域检索</p>
<p>多边形区域检索为高级权限，如有需求请提交<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/apiconsole/fankui">【工单】</a>咨询。</p>
<h3 id="服务文档">2、服务文档</h3>
<h4 id="行政区划区域检索-1">行政区划区域检索</h4>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/place/v2/search?query=ATM机&amp;tag=银行&amp;region=北京&amp;output=json&amp;ak=您的ak //GET请求</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kpea39sej21bj0u0jv2.jpg"
alt="image-20220525155517417" />
<figcaption aria-hidden="true">image-20220525155517417</figcaption>
</figure>
<p>返回结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kpqvle6bj21at0u0gpr.jpg"
alt="image-20220525155559662" />
<figcaption aria-hidden="true">image-20220525155559662</figcaption>
</figure>
<h4 id="圆形区域检索-1">圆形区域检索</h4>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/place/v2/search?query=银行&amp;location=39.915,116.404&amp;radius=2000&amp;output=xml&amp;ak=您的密钥 //GET请求		</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kpqtoq0zj21c10u0ada.jpg"
alt="image-20220525160718360" />
<figcaption aria-hidden="true">image-20220525160718360</figcaption>
</figure>
<p>其中<strong>query</strong>是检索关键字。圆形区域检索和矩形区域内检索支持多个关键字并集检索，不同关键字间以<span
class="math inline">\(符号分隔，最多支持10个关键字检索。如:”银行\)</span>酒店”
如果需要按POI分类进行检索，请将分类通过query参数进行设置，如query=美食</p>
<p><strong>page_size</strong>单次召回POI数量，默认为10条记录，最大返回20条</p>
<p>返回结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kpwnzk3zj21eb0u0tci.jpg"
alt="image-20220525161252826" />
<figcaption aria-hidden="true">image-20220525161252826</figcaption>
</figure>
<h4 id="地点详情检索服务"><strong>地点详情检索服务</strong></h4>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/place/v2/detail?uid=435d7aea036e54355abbbcc8&amp;output=json&amp;scope=2&amp;ak=您的密钥 //GET请求</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kq7iswh5j21cg0u0goy.jpg"
alt="image-20220525162320156" />
<figcaption aria-hidden="true">image-20220525162320156</figcaption>
</figure>
<p>返回结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kq7x6z69j21on0u078k.jpg"
alt="image-20220525162346216" />
<figcaption aria-hidden="true">image-20220525162346216</figcaption>
</figure>
<h2 id="section"></h2>
<h2 id="地址输入提示服务">地址输入提示服务</h2>
<blockquote>
<p>地点输入提示服务（又名Place Suggestion API）是一类Web
API接口服务；</p>
<p>匹配用户输入内容，提供输入提示功能。常与<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-placeapi">地点检索</a>服务搭配使用。也可作为轻量级地点检索服务单独使用（不支持复杂检索场景）。</p>
</blockquote>
<h3 id="功能介绍-1">1、功能介绍</h3>
<p>地点输入提示</p>
<p>用户可通过该服务，匹配用户输入关键词的地点推荐列表。
在应用方面，可将地点推荐列表展示给用户，用户可通过点击等交互方式，结合<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-placeapi">地点检索</a>服务，检索用户点击的POI信息，实现地点详情检索功能。</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kqha6lpsj20bk06w74q.jpg"
alt="Sug1.png" />
<figcaption aria-hidden="true">Sug1.png</figcaption>
</figure>
<p>轻量级地点检索</p>
<p>通过关键词和检索城市限制，可满足轻量级地点检索需求，获取地点基础数据</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kqhhitnvj20bk06ydgb.jpg"
alt="Sug2.png" />
<figcaption aria-hidden="true">Sug2.png</figcaption>
</figure>
<h3 id="服务文档-1">2、服务文档</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/place/v2/suggestion?query=天安门&amp;region=北京&amp;city_limit=true&amp;output=json&amp;ak=你的ak //GET请求</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kr29th27j21ij0u041o.jpg"
alt="image-20220525165254126" />
<figcaption aria-hidden="true">image-20220525165254126</figcaption>
</figure>
<p>结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2kr2lkhg0j21e00u0n0l.jpg"
alt="image-20220525165312858" />
<figcaption aria-hidden="true">image-20220525165312858</figcaption>
</figure>
<h2 id="正逆地理编码服务">正/逆地理编码服务</h2>
<blockquote>
<p>地理编码服务（又名Geocoder）是一类Web API接口服务；
<strong>地理编码服务</strong>提供将结构化地址数据（如：北京市海淀区上地十街十号）转换为对应坐标点（经纬度）功能；
地理编码服务当前未推出国际化服务，解析地址仅限国内；</p>
</blockquote>
<h3 id="功能介绍-2">1、功能介绍</h3>
<p>地理编码服务</p>
<p>用户可通过该功能，将结构化地址（省/市/区/街道/门牌号）解析为对应的位置坐标。地址结构越完整，地址内容越准确，解析的坐标精度越高。</p>
<h3 id="服务文档-2">2、服务文档</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号&amp;output=json&amp;ak=您的ak&amp;callback=showLocation //GET请求</span></span><br><span class="line">注意：当前为V3<span class="number">.0</span>版本接口文档，V2<span class="number">.0</span>及以前版本自<span class="number">2019.6</span><span class="number">.18</span>起新用户无法使用。老用户仍可继续使用V2<span class="number">.0</span>及以前版本请求实现逆地理编码服务，为保障用户体验，建议您尽快迁移到V3<span class="number">.0</span>版本。</span><br></pre></td></tr></table></figure>
<p>请求如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2krujqqxjj21eo0u041r.jpg"
alt="image-20220525172003357" />
<figcaption aria-hidden="true">image-20220525172003357</figcaption>
</figure>
<p>结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2krv0kvzsj21hf0u00vn.jpg"
alt="image-20220525172031112" />
<figcaption aria-hidden="true">image-20220525172031112</figcaption>
</figure>
<h2 id="天气查询">天气查询</h2>
<h3 id="功能介绍-3">1、功能介绍</h3>
<p>国内天气查询服务分为基础服务和高级权限。
在基础服务中，用户可通过行政区划代码查询实时天气信息及未来5天天气预报。
在高级权限中，用户可通过经纬度查询实时天气信息、未来7天天气预报及未来24小时逐小时预报。同时，用户还可以通过高级权限获取空气质量指数、生活指数、气象预警等丰富信息。高级权限需付费开通，您可以<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/apiconsole/fankui#?typeOne=产品需求&amp;typeTwo=高级服务">联系我们</a>开通15天试用并了解更多信息。</p>
<h3 id="服务文档-3">2、服务文档</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/weather/v1/?district_id=222405&amp;data_type=all&amp;ak=你的ak  //GET请求	</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2ks9urql4j21ex0u0q6d.jpg"
alt="image-20220525173446676" />
<figcaption aria-hidden="true">image-20220525173446676</figcaption>
</figure>
<p>结果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2ksa9ae70j21cf0u0tc7.jpg"
alt="image-20220525173509954" />
<figcaption aria-hidden="true">image-20220525173509954</figcaption>
</figure>
<h2 id="地址解析聚合">地址解析聚合</h2>
<h3 id="功能介绍-4">1、功能介绍</h3>
<p>该服务用于解析地址结构。结合自然语言理解能力，可以对地址信息按照文本信息、空间位置信息等因子进行区域化聚合。同时也可解析并提取地址中核心结构，如行政区划（省、市、区、乡镇）、街道、POI，以及地址中的联系人，联系方式等信息，并对地址进行一定的补全和纠错。</p>
<p>聚合模式</p>
<p>将地址按照基础地物进行分类聚合，结合百度地图领先的地图地理信息解析能力以及百度NLP自然语言能力，对地址信息进行结构化理解，并结合基础地图单位进行位置聚合。
目前可聚合的单位为：省、市、区县、乡镇街道、道路、路段、末端地点（POI或AOI）</p>
<p>标准化模式</p>
<p>结构化解析并提取复杂地址中的核心内容，包含人名、联系方式、行政区划结构（省、市、区县、乡镇街道）、POI信息。</p>
<p>异常地址识别服务</p>
<p>针对系统传入地址进行判断是否存在不合规的情况，通过找到不合规的case问题，系统给用户提示问题的原因，来协助降低地址输入时的错误率。</p>
<h3 id="服务文档-4">2、服务文档</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https<span class="punctuation">:</span><span class="comment">//api.map.baidu.com/address_analyzer/v1?address=北京市海淀区信息路甲九号&amp;ak=你的ak</span></span><br></pre></td></tr></table></figure>
<p><strong>付费服务</strong></p>
<h2 id="javascript-api-v3.0">JavaScript API v3.0</h2>
<h3 id="使用方法">使用方法</h3>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2mpk27rybj20p4039jrf.jpg"
alt="image-20220527093150127" />
<figcaption aria-hidden="true">image-20220527093150127</figcaption>
</figure>
<p>ak申请需要选择浏览器端-Javascript API</p>
<h3 id="百度地图的hello-world">百度地图的Hello World</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1.0, user-scalable=no&quot;</span> /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello, World<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css">  </span></span><br><span class="line"><span class="language-css"><span class="selector-tag">html</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>&#125;  </span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>;<span class="attribute">margin</span>:<span class="number">0px</span>;<span class="attribute">padding</span>:<span class="number">0px</span>&#125;  </span></span><br><span class="line"><span class="language-css"><span class="selector-id">#container</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>&#125;  </span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//v3.0版本的引用方式：src=&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span>  </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 创建地图实例  </span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 创建点坐标  </span></span></span><br><span class="line"><span class="language-javascript">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化地图，设置中心点坐标和地图级别  </span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="分步步骤">分步步骤：</h3>
<h4 id="申请百度账号和ak">1申请百度账号和ak</h4>
<p><a target="_blank" rel="noopener" href="https://lbs.baidu.com/apiconsole/key">点我申请</a></p>
<h4 id="准备页面">2准备页面</h4>
<p>根据HTML标准，每一份HTML文档都应该声明正确的文档类型，我们建议您使用最新的符合HTML5规范的文档声明：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>您也可以根据需要选择其他类型的文档声明，这样浏览器会以标准的方式对页面进行渲染，保证页面最大的兼容性。我们不建议您使用quirks模式进行开发。</p>
<h4 id="适应移动端页面展示">3适应移动端页面展示</h4>
<p>下面我们添加一个meta标签，以便使您的页面更好的在移动平台上展示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1.0, user-scalable=no&quot;</span> /&gt;</span>  </span><br></pre></td></tr></table></figure>
<h4 id="设置容器样式">4设置容器样式</h4>
<p>设置容器样式大小，使地图充满整个浏览器窗口：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css">  </span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">html</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>&#125;    </span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>;<span class="attribute">margin</span>:<span class="number">0px</span>;<span class="attribute">padding</span>:<span class="number">0px</span>&#125;    </span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#container</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>&#125;    </span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<h4 id="引用百度地图api文件">5引用百度地图API文件</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/api?v=3.0&amp;ak=您的密钥&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="创建地图容器元素">6创建地图容器元素</h4>
<p>地图需要一个HTML元素作为容器，这样才能展现到页面上。这里我们创建了一个div元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<h4 id="创建地图实例">7创建地图实例</h4>
<p>位于BMap命名空间下的Map类表示地图，通过new操作符可以创建一个地图实例。其参数可以是元素id也可以是元素对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br></pre></td></tr></table></figure>
<p>注意：</p>
<p>1.在调用此构造函数时应确保容器元素已经添加到地图上。</p>
<p>2.命名空间
API使用BMap作为命名空间，所有类均在该命名空间之下，比如：BMap.Map、BMap.Control、BMap.Overlay。</p>
<h4 id="设置中心点坐标">8设置中心点坐标</h4>
<p>这里我们使用BMap命名空间下的Point类来创建一个坐标点。Point类描述了一个地理坐标点，其中116.404表示经度，39.915表示纬度。（为天安门坐标）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>); </span><br></pre></td></tr></table></figure>
<p>注意：在使用百度地图JavaScript
API服务时，需使用百度BD09坐标，如使用其他坐标（
WGS84、GCJ02）进行展示，需先将其他坐标转换为BD09，详细说明请参考坐标转换说明，请勿使用非官方的转换方法！！！</p>
<h4
id="地图初始化同时设置地图展示级别">9地图初始化，同时设置地图展示级别</h4>
<p>在创建地图实例后，我们需要对其进行初始化，BMap.Map.centerAndZoom()方法要求设置中心点坐标和地图级别。
地图必须经过初始化才可以执行其他操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);  </span><br></pre></td></tr></table></figure>
<p>至此，我们就快速创建了一张以天安门为中心的地图~</p>
<h3 id="地图配置与操作">1、地图配置与操作</h3>
<p><strong>默认情况下地图不支持鼠标滚轮缩放操作，如果希望在地图中使用鼠标滚轮控制缩放，可以调用map.enableScrollWheelZoom方法来开启。配置选项可以在Map类参考中找到。</strong></p>
<p>map.enableScrollWheelZoom方法来开启。配置选项可以在Map类参考中找到。</p>
<p>此外，您还可以通过编程的方式与地图交互。Map类提供了若干修改地图状态的方法。例如：setCenter()、panTo()、zoomTo()等等。</p>
<p>示例：
等待两秒钟后，地图它会移动到新中心点。panTo()方法将让地图平滑移动至新中心点，如果移动距离超过了当前地图区域大小，则地图会直跳到该点。</p>
<h3 id="坐标转换说明">2、坐标转换说明</h3>
<p>目前国内主要有以下三种坐标系：</p>
<p>WGS84：为一种大地坐标系，也是目前广泛使用的GPS全球卫星定位系统使用的坐标系。</p>
<p>GCJ02：又称火星坐标系，是由中国国家测绘局制订的地理信息系统的坐标系统。由WGS84坐标系经加密后的坐标系。</p>
<p>BD09：为百度坐标系，在GCJ02坐标系基础上再次加密。其中bd09ll表示百度经纬度坐标，bd09mc表示百度墨卡托米制坐标。</p>
<p>非中国地区地图，服务坐标统一使用WGS84坐标。</p>
<p>其他坐标转百度坐标</p>
<p>百度对外接口的坐标系为BD09坐标系，并不是GPS采集的真实经纬度，在使用百度地图JavaScript
API服务前，需先将非百度坐标通过坐标转换接口转换成百度坐标。
坐标转换、批量坐标转换示例详见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/jsdemo.htm#a5_2"><strong>JavaScript
API示例</strong></a>。</p>
<h3 id="添加控件">3、添加控件</h3>
<blockquote>
<p>百度地图上负责与地图交互的UI元素称为控件。百度地图API中提供了丰富的控件，您还可以通过Control类来实现自定义控件。</p>
</blockquote>
<h4 id="提供的控件">提供的控件</h4>
<p>提供的控件</p>
<p>详情可见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a2b0">类参考</a>。</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 20%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr>
<th><strong>控件</strong></th>
<th><strong>类名</strong></th>
<th><strong>简介</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>抽象基类</td>
<td>Control</td>
<td>所有控件均继承此类的方法、属性。通过此类您可实现自定义控件</td>
</tr>
<tr>
<td>平移缩放控件</td>
<td>NavigationControl</td>
<td>PC端默认位于地图左上方，它包含控制地图的平移和缩放的功能。移动端提供缩放控件，默认位于地图右下方</td>
</tr>
<tr>
<td>缩略地图</td>
<td>OverviewMapControl</td>
<td>默认位于地图右下方，是一个可折叠的缩略地图</td>
</tr>
<tr>
<td>比例尺</td>
<td>ScaleControl</td>
<td>默认位于地图左下方，显示地图的比例关系</td>
</tr>
<tr>
<td>地图类型</td>
<td>MapTypeControl</td>
<td>默认位于地图右上方</td>
</tr>
<tr>
<td>版权</td>
<td>CopyrightControl</td>
<td>默认位于地图左下方</td>
</tr>
<tr>
<td>定位</td>
<td>GeolocationControl</td>
<td>针对移动端开发，默认位于地图左下方</td>
</tr>
</tbody>
</table>
<h4 id="向地图添加控件">向地图添加控件</h4>
<blockquote>
<p>可以使用Map.addControl()方法向地图添加控件。</p>
</blockquote>
<h5 id="地图初始化">1地图初始化</h5>
<p>添加控件前，地图需要进行初始化。例如，要将标准地图控件添加到地图中，可在代码中添加如下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">NavigationControl</span>());</span><br></pre></td></tr></table></figure>
<p>添加平移缩放控件效果如下：</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24egy1h2mr7zc8brj203b06caa2.jpg"
alt="image-20220527102930582" />
<figcaption aria-hidden="true">image-20220527102930582</figcaption>
</figure>
<h5 id="添加多个控件">2添加多个控件</h5>
<p>在本例中我们向地图添加一个平移缩放控件、一个比例尺控件和一个缩略图控件。在地图中添加控件后，它们即刻生效。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">NavigationControl</span>());    </span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">ScaleControl</span>());    </span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">OverviewMapControl</span>());    </span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">MapTypeControl</span>());    </span><br><span class="line">map.<span class="title function_">setCurrentCity</span>(<span class="string">&quot;北京&quot;</span>); <span class="comment">// 仅当设置城市信息时，MapTypeControl的切换功能才能可用</span></span><br></pre></td></tr></table></figure>
<h4 id="控制控件位置">控制控件位置</h4>
<p>初始化控件时，可提供一个可选参数，其中的anchor和offset属性共同控制控件在地图上的位置。
anchor表示控件的停靠位置，即控件停靠在地图的哪个角。当地图尺寸发生变化时，控件会根据停靠位置的不同来调整自己的位置。</p>
<table>
<thead>
<tr>
<th><strong>anchor值</strong></th>
<th><strong>位置说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BMAP_ANCHOR_TOP_LEFT</td>
<td>表示控件定位于地图的左上角</td>
</tr>
<tr>
<td>BMAP_ANCHOR_TOP_RIGHT</td>
<td>表示控件定位于地图的右上角</td>
</tr>
<tr>
<td>BMAP_ANCHOR_BOTTOM_LEFT</td>
<td>表示控件定位于地图的左下角</td>
</tr>
<tr>
<td>BMAP_ANCHOR_BOTTOM_RIGHT</td>
<td>表示控件定位于地图的右下角</td>
</tr>
</tbody>
</table>
<p>控件位置偏移</p>
<p>除了指定停靠位置外，还可以通过偏移量来指示控件距离地图边界有多少像素。如果两个控件的停靠位置相同，那么控件可能会重叠在一起，这时就可以通过偏移值使二者分开显示。</p>
<p>如下示例为：将比例尺放置在地图的左下角，由于API默认会有版权信息，因此需要添加一些偏移值以防止控件重叠。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> opts = &#123;<span class="attr">offset</span>: <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">150</span>, <span class="number">5</span>)&#125;</span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">ScaleControl</span>(opts));</span><br></pre></td></tr></table></figure>
<h4 id="修改控件配置">修改控件配置</h4>
<p>地图API的控件提供了丰富的配置参数，您可参考API文档来修改它们以便得到符合要求的控件外观。例如，NavigationControl控件就提供了如下类型：</p>
<table>
<thead>
<tr>
<th><strong>平移缩放控件的类型</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BMAP_NAVIGATION_CONTROL_LARGE</td>
<td>表示显示完整的平移缩放控件</td>
</tr>
<tr>
<td>BMAP_NAVIGATION_CONTROL_SMALL</td>
<td>表示显示小型的平移缩放控件</td>
</tr>
<tr>
<td>BMAP_NAVIGATION_CONTROL_PAN</td>
<td>表示只显示控件的平移部分功能</td>
</tr>
<tr>
<td>BMAP_NAVIGATION_CONTROL_ZOOM</td>
<td>表示只显示控件的缩放部分功能</td>
</tr>
</tbody>
</table>
<p>下图从左向右依次展示了上述不同类型的控件外观，前四个为PC端平移缩放控件样式，最后一个为移动端缩放控件样式：
<img
src="https://mapopen-website-wiki.cdn.bcebos.com/static/img/control.png"
alt="control.png" /></p>
<p>如下示例为：将调整平移缩放地图控件的外观。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> opts = &#123;<span class="attr">type</span>: <span class="variable constant_">BMAP_NAVIGATION_CONTROL_SMALL</span>&#125;    </span><br><span class="line">map.<span class="title function_">addControl</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">NavigationControl</span>(opts));</span><br></pre></td></tr></table></figure>
<h4 id="自定义控件">自定义控件</h4>
<p>百度地图API允许您通过继承Control来创建自定义地图控件。</p>
<p>1定义一个自定义控件的构造函数并继承Control</p>
<p>您需要定义自定义控件的构造函数，并在构造函数中提供defaultAnchor和defaultOffset两个属性，以便API正确定位控件位置，接着让其继承于Control。在下面的示例中我们定义一个名为ZoomControl的控件，每一次点击将地图放大两个级别。它具有文本标识，而不是平移缩放控件中使用的图形图标。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个控件类，即function    </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ZoomControl</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="comment">// 设置默认停靠位置和偏移量  </span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultAnchor</span> = <span class="variable constant_">BMAP_ANCHOR_TOP_LEFT</span>;    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">defaultOffset</span> = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">10</span>, <span class="number">10</span>);    </span><br><span class="line">&#125;    </span><br><span class="line"><span class="comment">// 通过JavaScript的prototype属性继承于BMap.Control   </span></span><br><span class="line"><span class="title class_">ZoomControl</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Control</span>();</span><br></pre></td></tr></table></figure>
<p>2初始化自定义控件</p>
<p>设置自定义控件构造函数的prototype属性为Control的实例，以便继承控件基类。</p>
<p>当调用map.addControl()方法添加自定义控件时，API会调用该对象的initialize()方法用来初始化控件，您需要实现此方法并在其中创建控件所需的DOM元素，并添加DOM事件。所有自定义控件中的DOM元素最终都应该添加到地图容器（即地图所在的DOM元素）中去，地图容器可以通过map.getContainer()方法获得。最后initialize()方法需要返回控件容器的DOM元素。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义控件必须实现initialize方法，并且将控件的DOM元素返回   </span></span><br><span class="line"><span class="comment">// 在本方法中创建个div元素作为控件的容器，并将其添加到地图容器中   </span></span><br><span class="line"><span class="title class_">ZoomControl</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">initialize</span> = <span class="keyword">function</span>(<span class="params">map</span>)&#123;    </span><br><span class="line">    <span class="comment">// 创建一个DOM元素   </span></span><br><span class="line">    <span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);    </span><br><span class="line">    <span class="comment">// 添加文字说明    </span></span><br><span class="line">    div.<span class="title function_">appendChild</span>(<span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;放大2级&quot;</span>));    </span><br><span class="line">    <span class="comment">// 设置样式    </span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&quot;pointer&quot;</span>;    </span><br><span class="line">    div.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&quot;1px solid gray&quot;</span>;    </span><br><span class="line">    div.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;white&quot;</span>;    </span><br><span class="line">    <span class="comment">// 绑定事件，点击一次放大两级    </span></span><br><span class="line">    div.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params">e</span>)&#123;  </span><br><span class="line">        map.<span class="title function_">zoomTo</span>(map.<span class="title function_">getZoom</span>() + <span class="number">2</span>);    </span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="comment">// 添加DOM元素到地图中   </span></span><br><span class="line">    map.<span class="title function_">getContainer</span>().<span class="title function_">appendChild</span>(div);    </span><br><span class="line">    <span class="comment">// 将DOM元素返回  </span></span><br><span class="line">    <span class="keyword">return</span> div;    </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>3添加自定义控件</p>
<p>添加自定义控件与添加其他控件方法一致，调用map.addControl()方法即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建控件实例    </span></span><br><span class="line"><span class="keyword">var</span> myZoomCtrl = <span class="keyword">new</span> <span class="title class_">ZoomControl</span>();    </span><br><span class="line"><span class="comment">// 添加到地图当中    </span></span><br><span class="line">map.<span class="title function_">addControl</span>(myZoomCtrl);</span><br></pre></td></tr></table></figure>
<h3 id="标注">4、标注</h3>
<blockquote>
<p>所有叠加或覆盖到地图的内容，我们统称为地图覆盖物。覆盖物拥有自己的地理坐标，当您拖动或缩放地图时，它们会相应的移动。</p>
<p>覆盖物主要分为：标注（点标注、矢量图形（包括折线、多边形、圆））、信息窗口、图层。</p>
<p>本节重点介绍一下如何向地图添加标注，以及与地图相关的一些交互。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">		<span class="selector-tag">body</span>, <span class="selector-tag">html</span>&#123;<span class="attribute">width</span>: <span class="number">100%</span>;<span class="attribute">height</span>: <span class="number">100%</span>;<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">font-family</span>:<span class="string">&quot;微软雅黑&quot;</span>;&#125;</span></span><br><span class="line"><span class="language-css">		<span class="selector-id">#allmap</span>&#123;<span class="attribute">height</span>:<span class="number">500px</span>;<span class="attribute">width</span>:<span class="number">100%</span>;&#125;</span></span><br><span class="line"><span class="language-css">		<span class="selector-id">#r-result</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;&#125;</span></span><br><span class="line"><span class="language-css">	</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//api.map.baidu.com/api?v=2.0&amp;ak=您的密钥&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>添加/删除覆盖物<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;allmap&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;r-result&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;add_overlay();&quot;</span> <span class="attr">value</span>=<span class="string">&quot;添加覆盖物&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;remove_overlay();&quot;</span> <span class="attr">value</span>=<span class="string">&quot;删除覆盖物&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="comment">// 百度地图API功能</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);</span></span><br><span class="line"><span class="language-javascript">	map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);</span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> marker = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>)); <span class="comment">// 创建点</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> polyline = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Polyline</span>([</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.399</span>, <span class="number">39.910</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.405</span>, <span class="number">39.920</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.425</span>, <span class="number">39.900</span>)</span></span><br><span class="line"><span class="language-javascript">	], &#123;<span class="attr">strokeColor</span>:<span class="string">&quot;blue&quot;</span>, <span class="attr">strokeWeight</span>:<span class="number">2</span>, <span class="attr">strokeOpacity</span>:<span class="number">0.5</span>&#125;);   <span class="comment">//创建折线</span></span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> circle = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Circle</span>(point,<span class="number">500</span>,&#123;<span class="attr">strokeColor</span>:<span class="string">&quot;blue&quot;</span>, <span class="attr">strokeWeight</span>:<span class="number">2</span>, <span class="attr">strokeOpacity</span>:<span class="number">0.5</span>&#125;); <span class="comment">//创建圆</span></span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> polygon = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Polygon</span>([</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.387112</span>,<span class="number">39.920977</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.385243</span>,<span class="number">39.913063</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.394226</span>,<span class="number">39.917988</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.401772</span>,<span class="number">39.921364</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.41248</span>,<span class="number">39.927893</span>)</span></span><br><span class="line"><span class="language-javascript">	], &#123;<span class="attr">strokeColor</span>:<span class="string">&quot;blue&quot;</span>, <span class="attr">strokeWeight</span>:<span class="number">2</span>, <span class="attr">strokeOpacity</span>:<span class="number">0.5</span>&#125;);  <span class="comment">//创建多边形</span></span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> pStart = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.392214</span>,<span class="number">39.918985</span>);</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> pEnd = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.41478</span>,<span class="number">39.911901</span>);</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">var</span> rectangle = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Polygon</span>([</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(pStart.<span class="property">lng</span>,pStart.<span class="property">lat</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(pEnd.<span class="property">lng</span>,pStart.<span class="property">lat</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(pEnd.<span class="property">lng</span>,pEnd.<span class="property">lat</span>),</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(pStart.<span class="property">lng</span>,pEnd.<span class="property">lat</span>)</span></span><br><span class="line"><span class="language-javascript">	], &#123;<span class="attr">strokeColor</span>:<span class="string">&quot;blue&quot;</span>, <span class="attr">strokeWeight</span>:<span class="number">2</span>, <span class="attr">strokeOpacity</span>:<span class="number">0.5</span>&#125;);  <span class="comment">//创建矩形</span></span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">//添加覆盖物</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">add_overlay</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">addOverlay</span>(marker);            <span class="comment">//增加点</span></span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">addOverlay</span>(polyline);          <span class="comment">//增加折线</span></span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">addOverlay</span>(circle);            <span class="comment">//增加圆</span></span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">addOverlay</span>(polygon);           <span class="comment">//增加多边形</span></span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">addOverlay</span>(rectangle);         <span class="comment">//增加矩形</span></span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">//清除覆盖物</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">remove_overlay</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		map.<span class="title function_">clearOverlays</span>();         </span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="提供的覆盖物">1、提供的覆盖物</h4>
<p>可以使用map.addOverlay方法向地图添加覆盖物，使用map.removeOverlay方法移除覆盖物，注意此方法不适用于InfoWindow。</p>
<p>详情请见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a3b0">类参考</a>。</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 17%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr>
<th><strong>覆盖物</strong></th>
<th><strong>类名</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>抽象基类</td>
<td>Overlay</td>
<td>所有的覆盖物均继承此类的方法</td>
</tr>
<tr>
<td>点</td>
<td>Marker</td>
<td>表示地图上的点，可自定义标注的图标</td>
</tr>
<tr>
<td>文本</td>
<td>Label</td>
<td>表示地图上的文本标注，您可以自定义标注的文本内容</td>
</tr>
<tr>
<td>折线</td>
<td>Polyline</td>
<td>表示地图上的折线</td>
</tr>
<tr>
<td>多边形</td>
<td>Polygon</td>
<td>表示地图上的多边形。多边形类似于闭合的折线，另外您也可以为其添加填充颜色</td>
</tr>
<tr>
<td>圆</td>
<td>Circle</td>
<td>表示地图上的圆</td>
</tr>
<tr>
<td>信息窗口</td>
<td>InfoWindow</td>
<td>信息窗口也是一种特殊的覆盖物，它可以展示更为丰富的文字和多媒体信息。注意：同一时刻只能有一个信息窗口在地图上打开</td>
</tr>
<tr>
<td>地面叠加层</td>
<td>GoundOverlay</td>
<td>表示叠加在地图上的图片，图片的链接、大小、位置等属性可以自定义</td>
</tr>
<tr>
<td>海量点</td>
<td>PointCollection</td>
<td>针对点的数量很大的情况，可以使用海量点进行展示</td>
</tr>
<tr>
<td>自定义覆盖物</td>
<td>自定义</td>
<td>支持通过继承覆盖物基类Overlay，自定义覆盖物</td>
</tr>
</tbody>
</table>
<h4 id="标注点">2、标注点</h4>
<p>Marker是一个用来往地图上添加点标记的类。使用它将任何你希望用户看到的兴趣点标注在地图上。</p>
<p>API提供了默认图标样式，您也可以通过Icon类来指定自定义图标。Marker的构造函数的参数为Point和MarkerOptions（可选）。</p>
<p>注意：当您使用自定义图标时，标注的地理坐标点将位于标注所用图标的中心位置，您可通过Icon的offset属性修改标定位置。</p>
<p>Marker使用详情请见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a3b2">类参考</a>。</p>
<p>1向地图添加标注</p>
<p>如下示例，向地图中心点添加了一个标注，并使用默认的标注样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);    </span><br><span class="line"><span class="keyword">var</span> marker = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(point);        <span class="comment">// 创建标注    </span></span><br><span class="line">map.<span class="title function_">addOverlay</span>(marker);                     <span class="comment">// 将标注添加到地图中 </span></span><br></pre></td></tr></table></figure>
<p>2定义标注图标</p>
<p>通过Icon类可实现自定义标注的图标，下面示例通过参数MarkerOptions的icon属性进行设置，您也可以使用marker.setIcon()方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);  <span class="comment">// 编写自定义函数，创建标注   </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addMarker</span>(<span class="params">point, index</span>)&#123;  <span class="comment">// 创建图标对象   </span></span><br><span class="line">    <span class="keyword">var</span> myIcon = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Icon</span>(<span class="string">&quot;markers.png&quot;</span>, <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">23</span>, <span class="number">25</span>), &#123;    </span><br><span class="line">        <span class="comment">// 指定定位位置。   </span></span><br><span class="line">        <span class="comment">// 当标注显示在地图上时，其所指向的地理位置距离图标左上    </span></span><br><span class="line">        <span class="comment">// 角各偏移10像素和25像素。您可以看到在本例中该位置即是   </span></span><br><span class="line">        <span class="comment">// 图标中央下端的尖角位置。    </span></span><br><span class="line">        <span class="attr">anchor</span>: <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">10</span>, <span class="number">25</span>),    </span><br><span class="line">        <span class="comment">// 设置图片偏移。   </span></span><br><span class="line">        <span class="comment">// 当您需要从一幅较大的图片中截取某部分作为标注图标时，您   </span></span><br><span class="line">        <span class="comment">// 需要指定大图的偏移位置，此做法与css sprites技术类似。    </span></span><br><span class="line">        <span class="attr">imageOffset</span>: <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">0</span>, <span class="number">0</span> - index * <span class="number">25</span>)   <span class="comment">// 设置图片偏移    </span></span><br><span class="line">    &#125;);      </span><br><span class="line">    <span class="comment">// 创建标注对象并添加到地图   </span></span><br><span class="line">    <span class="keyword">var</span> marker = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(point, &#123;<span class="attr">icon</span>: myIcon&#125;);    </span><br><span class="line">    map.<span class="title function_">addOverlay</span>(marker);    </span><br><span class="line">&#125;    </span><br><span class="line"><span class="comment">// 随机向地图添加10个标注    </span></span><br><span class="line"><span class="keyword">var</span> bounds = map.<span class="title function_">getBounds</span>();    </span><br><span class="line"><span class="keyword">var</span> lngSpan = bounds.<span class="property">maxX</span> - bounds.<span class="property">minX</span>;    </span><br><span class="line"><span class="keyword">var</span> latSpan = bounds.<span class="property">maxY</span> - bounds.<span class="property">minY</span>;    </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i ++) &#123;    </span><br><span class="line">    <span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(bounds.<span class="property">minX</span> + lngSpan * (<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">0.7</span> + <span class="number">0.15</span>),    </span><br><span class="line">                                  bounds.<span class="property">minY</span> + latSpan * (<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">0.7</span> + <span class="number">0.15</span>));    </span><br><span class="line">    <span class="title function_">addMarker</span>(point, i);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3监听标注事件</p>
<p>事件方法与Map事件机制相同。可参考<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/index.php?title=jspopular/guide/event">事件部分</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">marker.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;您点击了标注&quot;</span>);    </span><br><span class="line">&#125;);  </span><br></pre></td></tr></table></figure>
<p>4可拖拽的标注</p>
<p><a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference.html#a3b2">marker</a>的enableDragging和disableDragging方法可用来开启和关闭标注的拖拽功能。默认情况下标注不支持拖拽，您需要调用marker.enableDragging()方法来开启拖拽功能。在标注开启拖拽功能后，您可以监听标注的dragend事件来捕获拖拽后标注的最新位置。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">marker.<span class="title function_">enableDragging</span>();    </span><br><span class="line">marker.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragend&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;当前位置：&quot;</span> + e.<span class="property">point</span>.<span class="property">lng</span> + <span class="string">&quot;, &quot;</span> + e.<span class="property">point</span>.<span class="property">lat</span>);    </span><br><span class="line">&#125;)   </span><br></pre></td></tr></table></figure>
<h3 id="自定义标注">5、自定义标注</h3>
<blockquote>
<p>本节重点介绍如何向地图添加自定义标注覆盖物。 覆盖物相关使用详情请见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a3b0">类参考</a>。</p>
</blockquote>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2q9c0fcygj20pq0acac3.jpg"
alt="image-20220530111252651" />
<figcaption aria-hidden="true">image-20220530111252651</figcaption>
</figure>
<h5 id="定义构造函数并继承overlay">1、定义构造函数并继承Overlay</h5>
<p>首先您需要定义自定义覆盖物的构造函数，通过构造函数参数可以传递一些自由的变量。设置自定义覆盖物对象的prototype属性为<a
target="_blank" rel="noopener" href="https://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference.html#a3b0">Overlay</a>的实例，以便继承覆盖物基类。</p>
<p>如下示例，我们定义一个名为SquareOverlay的构造函数，它包含中心点和边长两个参数，用来在地图上创建一个方形覆盖物。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义自定义覆盖物的构造函数  </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SquareOverlay</span>(<span class="params">center, length, color</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_center</span> = center;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_length</span> = length;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_color</span> = color;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 继承API的BMap.Overlay</span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Overlay</span>();</span><br></pre></td></tr></table></figure>
<h5 id="初始化自定义覆盖物">2、初始化自定义覆盖物</h5>
<p>实现<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference.html#a3b0">initialize</a>方法，当调用map.addOverlay方法时，API会调用此方法。</p>
<p>当调用map.addOverlay方法添加自定义覆盖物时，API会调用该对象的initialize方法用来初始化覆盖物，在初始化过程中需要创建覆盖物所需要的DOM元素，并添加到地图相应的容器中。这里我们选择添加在容器markerPane上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现初始化方法  </span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">initialize</span> = <span class="keyword">function</span>(<span class="params">map</span>)&#123;</span><br><span class="line">    <span class="comment">// 保存map对象实例</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_map</span> = map;</span><br><span class="line">    <span class="comment">// 创建div元素，作为自定义覆盖物的容器</span></span><br><span class="line">    <span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    div.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;absolute&quot;</span>;</span><br><span class="line">    <span class="comment">// 可以根据参数设置元素外观</span></span><br><span class="line">    div.<span class="property">style</span>.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">_length</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    div.<span class="property">style</span>.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">_length</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    div.<span class="property">style</span>.<span class="property">background</span> = <span class="variable language_">this</span>.<span class="property">_color</span>;</span><br><span class="line">    <span class="comment">// 将div添加到覆盖物容器中</span></span><br><span class="line">    map.<span class="title function_">getPanes</span>().<span class="property">markerPane</span>.<span class="title function_">appendChild</span>(div);</span><br><span class="line">    <span class="comment">// 保存div实例</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_div</span> = div;</span><br><span class="line">    <span class="comment">// 需要将div元素作为方法的返回值，当调用该覆盖物的show、</span></span><br><span class="line">    <span class="comment">// hide方法，或者对覆盖物进行移除时，API都将操作此元素。</span></span><br><span class="line">    <span class="keyword">return</span> div;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>地图提供了若干容器供覆盖物展示，通过<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference.html#a3b0">map.getPanes</a>方法可以得到这些容器元素，它们包括：</p>
<p>floatPane</p>
<p>markerMouseTarget</p>
<p>floatShadow</p>
<p>labelPane</p>
<p>markerPane</p>
<p>mapPane</p>
<p>这些对象代表了不同的覆盖物容器元素，它们之间存在着覆盖关系，最上一层为floatPane，用于显示信息窗口内容，下面依次为标注点击区域层、信息窗口阴影层、文本标注层、标注层和矢量图形层。</p>
<p>我们自定义的方形覆盖物可以添加到任意图层上，如上示例，我们选择添加到markerPane上，作为其一个子结点。</p>
<h5 id="绘制覆盖物">3、绘制覆盖物</h5>
<p>实现<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference.html#a3b0">draw</a>方法。</p>
<p>到目前为止，我们仅仅把覆盖物添加到了地图上，但是并没有将它放置在正确的位置上。</p>
<p>您需要在draw方法中设置覆盖物的位置，每当地图状态发生变化（比如：位置移动、级别变化）时，API都会调用覆盖物的draw方法，用于重新计算覆盖物的位置。</p>
<p>通过map.pointToOverlayPixel方法可以将地理坐标转换到覆盖物的所需要的像素坐标。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现绘制方法   </span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">draw</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line"><span class="comment">// 根据地理坐标转换为像素坐标，并设置给容器    </span></span><br><span class="line">    <span class="keyword">var</span> position = <span class="variable language_">this</span>.<span class="property">_map</span>.<span class="title function_">pointToOverlayPixel</span>(<span class="variable language_">this</span>.<span class="property">_center</span>);    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_div</span>.<span class="property">style</span>.<span class="property">left</span> = position.<span class="property">x</span> - <span class="variable language_">this</span>.<span class="property">_length</span> / <span class="number">2</span> + <span class="string">&quot;px&quot;</span>;    </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_div</span>.<span class="property">style</span>.<span class="property">top</span> = position.<span class="property">y</span> - <span class="variable language_">this</span>.<span class="property">_length</span> / <span class="number">2</span> + <span class="string">&quot;px&quot;</span>;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="移除覆盖物">4、移除覆盖物</h5>
<p>当调用map.removeOverlay或者map.clearOverlays方法时，API会自动将initialize方法返回的DOM元素进行移除。</p>
<h5 id="显示和隐藏覆盖物">5、显示和隐藏覆盖物</h5>
<p>自定义覆盖物会自动继承Overlay的show和hide方法，方法会修改由initialize方法返回的DOM元素的style.display属性。</p>
<p>如果自定义覆盖物元素较为复杂，您也可以自己实现show和hide方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现显示方法    </span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">show</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_div</span>)&#123;    </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_div</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;&quot;</span>;    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;      </span><br><span class="line"><span class="comment">// 实现隐藏方法  </span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hide</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_div</span>)&#123;    </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_div</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自定义其他方法
通过构造函数的prototype属性，您可以添加任何自定义的方法，比如下面这个方法每调用一次就能改变覆盖物的显示状态：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加自定义方法   </span></span><br><span class="line"><span class="title class_">SquareOverlay</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toggle</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_div</span>)&#123;    </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_div</span>.<span class="property">style</span>.<span class="property">display</span> == <span class="string">&quot;&quot;</span>)&#123;    </span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">hide</span>();    </span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">else</span> &#123;    </span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">show</span>();    </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="添加覆盖物">6、添加覆盖物</h5>
<p>您现在已经完成了一个完整的自定义覆盖物的编写，可以添加到地图上了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化地图  </span></span><br><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);    </span><br><span class="line"><span class="comment">// 添加自定义覆盖物   </span></span><br><span class="line"><span class="keyword">var</span> mySquare = <span class="keyword">new</span> <span class="title class_">SquareOverlay</span>(map.<span class="title function_">getCenter</span>(), <span class="number">100</span>, <span class="string">&quot;red&quot;</span>);    </span><br><span class="line">map.<span class="title function_">addOverlay</span>(mySquare);</span><br></pre></td></tr></table></figure>
<h4 id="信息窗口">6、信息窗口</h4>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2q9jsko6aj20pt0acq4w.jpg"
alt="image-20220530112019539" />
<figcaption aria-hidden="true">image-20220530112019539</figcaption>
</figure>
<h5 id="提供的信息窗口">1、提供的信息窗口</h5>
<p>InfoWindow：信息窗口。也是一种特殊的覆盖物，它可以展示更为丰富的文字和多媒体信息。注意：同一时刻只能有一个信息窗口在地图上打开。</p>
<p>详情可见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a3b7">类参考</a>。</p>
<h5 id="添加信息窗口">2、添加信息窗口</h5>
<p>信息窗口是地图上方浮动显示的HTML内容，可直接在地图上的任意位置打开，也可以在标注对象上打开（此时信息窗口的坐标与标注的坐标一致）。</p>
<p>注意：同一时刻地图上只能有一个信息窗口处于打开状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> opts = &#123;    </span><br><span class="line">    width : <span class="number">250</span>,     <span class="comment">// 信息窗口宽度    </span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">100</span>,     <span class="comment">// 信息窗口高度    </span></span><br><span class="line">    title : <span class="string">&quot;Hello&quot;</span>  <span class="comment">// 信息窗口标题   </span></span><br><span class="line">&#125;    </span><br><span class="line"><span class="keyword">var</span> infoWindow = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">InfoWindow</span>(<span class="string">&quot;World&quot;</span>, opts);  <span class="comment">// 创建信息窗口对象    </span></span><br><span class="line">map.<span class="title function_">openInfoWindow</span>(infoWindow, map.<span class="title function_">getCenter</span>());      <span class="comment">// 打开信息窗口</span></span><br></pre></td></tr></table></figure>
<h5 id="提供的自定义信息窗口工具">3、提供的自定义信息窗口工具</h5>
<p>百度地图还向开发者提供自定义的信息窗口工具。</p>
<p>infoBox：自定义信息窗口工具。类似于infoWindow，比infoWindow更有灵活性，比如可以定制border，关闭按钮样式等。</p>
<p>详情可见<a
target="_blank" rel="noopener" href="http://api.map.baidu.com/library/InfoBox/1.2/docs/symbols/BMapLib.InfoBox.html">类参考</a>。<a
target="_blank" rel="noopener" href="http://api.map.baidu.com/library/InfoBox/1.2/examples/InfoBox_House.html">点击查看示例</a></p>
<h4 id="叠加图层">7、叠加图层</h4>
<blockquote>
<p>地图可以包含一个或多个图层，每个图层在每个级别都是由若干张图块组成的，它们覆盖了地球的整个表面。例如您所看到包括街道、兴趣点、学校、公园等内容的地图展现就是一个图层，另外交通流量的展现也是通过图层来实现的。</p>
<p><a target="_blank" rel="noopener" href="http://lbsyun.baidu.com/jsdemo.htm#g0_3">DEMO详情</a></p>
</blockquote>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2q9m2yo0ej20ps0a9gns.jpg"
alt="image-20220530112232097" />
<figcaption aria-hidden="true">image-20220530112232097</figcaption>
</figure>
<p>提供的图层</p>
<p>TrafficLayer：交通流量图层。详情可见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a6b2">类参考</a>。</p>
<p>添加和移除图层</p>
<p>通过map.addTileLayer方法可向地图添加图层，例如下面代码将显示北京市的交通流量。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;l-map&quot;</span>);         <span class="comment">// 创建地图实例      </span></span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);  <span class="comment">// 创建点坐标     </span></span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point, <span class="number">15</span>);                 <span class="comment">// 初始化地图，设置中心点坐标和地图级别     </span></span><br><span class="line"><span class="keyword">var</span> traffic = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">TrafficLayer</span>();        <span class="comment">// 创建交通流量图层实例      </span></span><br><span class="line">map.<span class="title function_">addTileLayer</span>(traffic);                    <span class="comment">// 将图层添加到地图上</span></span><br></pre></td></tr></table></figure>
<p>若要从地图上移除图层，需要调用map.removeTileLayer方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map.<span class="title function_">removeTileLayer</span>(traffic);                <span class="comment">// 将图层移除</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义叠加图层">8、自定义叠加图层</h4>
<blockquote>
<p>百度地图API支持丰富的图层展示，除了支持在“叠加图层页面”介绍的交通流量图层，还支持图片、栅格图，可以根据自己的实际情况实现自定义栅格图层和自定义图层。</p>
</blockquote>
<h5 id="基础知识百度地图坐标系">1、基础知识——百度地图坐标系</h5>
<p>在使用自定义方式叠加图层之前，您需要先了解百度地图的地图坐标系。
百度地图坐标系涉及：</p>
<ul>
<li><p>经纬度球面坐标系统</p></li>
<li><p>墨卡托平面坐标系统</p></li>
<li><p>图块编号系统</p></li>
</ul>
<h6 id="xy经纬度球面坐标系统">XY经纬度球面坐标系统</h6>
<p>经纬度是一种利用三维空间的球面来定义地球上的空间的球面坐标系，它能够标示地球上任何一个位置。</p>
<p>通过伦敦格林尼治天文台原址的经线为0度经线，从0度经线向东、向西各分180度。赤道为0度纬线，赤道以北的纬线称为北纬、以南的称为南纬。</p>
<p>在百度地图中，东经和北纬用正数表示，西经和南纬用负数表示。例如北京的位置大约是北纬39.9度，东经116.4度，那么用数值标示就是经度116.6，纬度39.9。</p>
<p>在百度地图中，习惯经度在前，纬度在后，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>);  <span class="comment">// 创建点坐标，经度在前，纬度在后</span></span><br></pre></td></tr></table></figure>
<h6 id="xy墨卡托平面坐标系统">XY墨卡托平面坐标系统</h6>
<p>由于百度地图是显示在平面上的，因此在地图内部系统中需要将球面坐标转换为平面坐标，这个转换过程称为投影。</p>
<p>百度地图使用的是墨卡托投影。墨卡托平面坐标如下图所示，平面坐标与经纬度坐标系的原点是重合的。</p>
<figure>
<img
src="https://mapopen-website-wiki.cdn.bcebos.com/static/img/jsguide05.jpg"
alt="jsguide05.jpg" />
<figcaption aria-hidden="true">jsguide05.jpg</figcaption>
</figure>
<h6 id="xy图块编号系统">XY图块编号系统</h6>
<p>百度地图在每一个级别将整个地图划分成若干个图块，通过编号系统将整个图块整合在一起以便显示完整的地图。当地图被拖动或者级别发生变化时，地图API将会根据平面坐标计算出当前视野内所需显示的图块的编号。</p>
<p>百度地图图块编号规则如下图所示：</p>
<figure>
<img
src="https://mapopen-website-wiki.cdn.bcebos.com/static/img/jsguide06.jpg"
alt="jsguide06.jpg" />
<figcaption aria-hidden="true">jsguide06.jpg</figcaption>
</figure>
<p>从平面坐标原点开始的右上方向的图块编号为0,0，以此类推。在最低的缩放级别（级别
1）中，整个地球由4张图块组成。随着级别的增长，地图所使用的图块个数也随之增多。</p>
<h4 id="自定义绘制层">9、自定义绘制层</h4>
<blockquote>
<p>JavaScript API v3.0
的Overlay中，新增了CanvasLayer类。提供了在地图上绘制自定义的Canvas2D或WebGL覆盖物的功能。绘制的覆盖物和其他的Overlay一样，会根据自己的经纬度贴合在地图上。</p>
</blockquote>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2qef8k5iaj20pr0a4dim.jpg"
alt="image-20220530140900099" />
<figcaption aria-hidden="true">image-20220530140900099</figcaption>
</figure>
<p>创建Canvas2D覆盖物</p>
<p>CanvasLayer类提供了在地图上进行Web前端canvas绘制的功能。具体的canvas绘制方法和逻辑可以参考canvas的相关资料。
使用CanvasLayer的简单示例如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mp = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span><br><span class="line">mp.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.3964</span>,<span class="number">39.9093</span>), <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> canvasLayer = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">CanvasLayer</span>(&#123;</span><br><span class="line">    <span class="attr">update</span>: update</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ctx = <span class="variable language_">this</span>.<span class="property">canvas</span>.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!ctx) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, ctx.<span class="property">canvas</span>.<span class="property">width</span>, ctx.<span class="property">canvas</span>.<span class="property">height</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> temp = &#123;&#125;;</span><br><span class="line">    ctx.<span class="property">fillStyle</span> = <span class="string">&quot;rgba(50, 50, 255, 0.7)&quot;</span>;</span><br><span class="line">    ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">    <span class="keyword">var</span> data = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.297047</span>,<span class="number">39.979542</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.321768</span>,<span class="number">39.88748</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.494243</span>,<span class="number">39.956539</span>)</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = data.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绘制时需要对经纬度进行转换</span></span><br><span class="line">        <span class="keyword">var</span> pixel = mp.<span class="title function_">pointToPixel</span>(data[i]);</span><br><span class="line"></span><br><span class="line">        ctx.<span class="title function_">fillRect</span>(pixel.<span class="property">x</span>, pixel.<span class="property">y</span>, <span class="number">30</span>, <span class="number">30</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mp.<span class="title function_">addOverlay</span>(canvasLayer);</span><br></pre></td></tr></table></figure>
<p>注意这里的api应该使用3.0版本的 而不是2.0版本的
不然会导致<strong>Uncaught TypeError: BMap.CanvasLayer is not a
constructor</strong></p>
<h4 id="事件处理">10、 事件处理</h4>
<blockquote>
<p>浏览器中的JavaScript是“事件驱动的”，这表示JavaScript通过生成事件来响应交互，并期望程序能够“监听”感兴趣的活动。例如，在浏览器中，用户的鼠标和键盘交互可以创建在DOM内传播的事件。对某些事件感兴趣的程序会为这些事件注册JavaScript事件监听器，并在接收这些事件时执行代码。</p>
<p>百度地图API拥有一个自己的事件模型，程序员可监听地图API对象的自定义事件，使用方法和DOM事件类似。但请注意，地图API事件是独立的，与标准DOM事件不同。</p>
</blockquote>
<h5 id="事件监听">1、事件监听</h5>
<p>百度地图API中的大部分对象都含有addEventListener方法，您可以通过该方法来监听对象事件。例如，BMap.Map包含click、dblclick等事件。在特定环境下这些事件会被触发，同时监听函数会得到相应的事件参数e，比如当用户点击地图时，e参数会包含鼠标所对应的地理位置point。</p>
<p>有关地图API对象的事件，请参考完整的<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html">API类参考文档</a>。</p>
<h6 id="弹窗事件">1弹窗事件</h6>
<p>addEventListener方法有两个参数：监听的事件名称和事件触发时调用的函数。</p>
<p>如下示例中，每当用户点击地图时，会弹出一个警告框：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;您点击了地图。&quot;</span>);    </span><br><span class="line">&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h6 id="捕获状态">2捕获状态</h6>
<p>通过监听事件还可以捕获事件触发后的状态。</p>
<p>如下示例，显示用户拖动地图后地图中心的经纬度信息：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragend&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">var</span> center = map.<span class="title function_">getCenter</span>();    </span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;地图中心点变更为：&quot;</span> + center.<span class="property">lng</span> + <span class="string">&quot;, &quot;</span> + center.<span class="property">lat</span>);    </span><br><span class="line">&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h5 id="事件参数和this">2、事件参数和this</h5>
<p>在标准的DOM事件模型中（DOM Level 2
Events），监听函数会得到一个事件对象e，在e中可以获取有关该事件的信息。同时在监听函数中this会指向触发该事件的DOM元素。</p>
<p>百度地图API的事件模型与此类似，在事件监听函数中传递事件对象e，每个e参数至少包含事件类型（type）和触发该事件的对象（target）。</p>
<p>API还保证函数内的this指向触发（同时也是绑定）事件的API对象。</p>
<h6 id="事件参数e获取有关信息">1事件参数e获取有关信息</h6>
<p>例如，通过参数e得到点击的经纬度坐标：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(e.<span class="property">point</span>.<span class="property">lng</span> + <span class="string">&quot;, &quot;</span> + e.<span class="property">point</span>.<span class="property">lat</span>);    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h6 id="this指向dom元素">2this指向DOM元素</h6>
<p>监听函数中this会指向触发该事件的DOM元素。</p>
<p>如下示例，通过this得到地图缩放后的级别：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;zoomend&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;地图缩放至：&quot;</span> + <span class="variable language_">this</span>.<span class="title function_">getZoom</span>() + <span class="string">&quot;级&quot;</span>);    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="移除监听事件">3、移除监听事件</h5>
<p>当您不再希望监听事件时，可以将事件监听进行移除。每个API对象提供了removeEventListener用来移除事件监听函数。</p>
<h6 id="移除监听事件-1">1移除监听事件</h6>
<p>如下示例中，用户第一次点击地图会触发事件监听函数，在函数内部对事件监听进行了移除，因此后续的点击操作则不会触发监听函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);    </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showInfo</span>(<span class="params">e</span>)&#123;    </span><br><span class="line">    <span class="title function_">alert</span>(e.<span class="property">point</span>.<span class="property">lng</span> + <span class="string">&quot;, &quot;</span> + e.<span class="property">point</span>.<span class="property">lat</span>);    </span><br><span class="line">    map.<span class="title function_">removeEventListener</span>(<span class="string">&quot;click&quot;</span>, showInfo);    </span><br><span class="line">&#125;    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, showInfo);</span><br></pre></td></tr></table></figure>
<h4 id="检索poi">11、检索POI</h4>
<blockquote>
<p>简介</p>
<p>检索服务提供某一特定地区的兴趣点位置查询服务（POI：Point of
Interest，感兴趣点）。允许设置检索城市、检索圆形区域内POI、检索矩形区域内POI、检索结果详情。</p>
</blockquote>
<h5 id="提供的检索服务">1、提供的检索服务</h5>
<p>LocalSearch：本地搜索，提供某一特定地区的位置搜索服务，比如在北京市搜索“公园”。目前支持城市检索、圆形检索、矩形检索。详情可见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b33">类参考</a>。</p>
<p>说明：BMap.LocalSearch提供本地搜索服务，在使用本地搜索时需要为其设置一个检索区域，检索区域可以是BMap.Map对象、BMap.Point对象或者是省市名称（比如："北京市"）的字符串。BMap.LocalSearch构造函数的第二个参数是可选的，您可以在其中指定结果的呈现。BMap.RenderOptions类提供了若干控制呈现的属性，其中map指定了结果所展现的地图实例，panel指定了结果列表的容器元素。</p>
<h5 id="检索poi方法">2、检索POI方法</h5>
<p>检索POI服务提供三种检索方法：城市检索、圆形区域检索、矩形区域检索。</p>
<h6 id="城市检索">1城市检索</h6>
<p><a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">search方法</a>提供根据关键字检索特定POI信息服务。
如下示例，为根据关键字“天安门”检索POI：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);      </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);      </span><br><span class="line"><span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map, &#123;      </span><br><span class="line">    <span class="attr">renderOptions</span>:&#123;<span class="attr">map</span>: map&#125;      </span><br><span class="line">&#125;);      </span><br><span class="line">local.<span class="title function_">search</span>(<span class="string">&quot;天安门&quot;</span>);</span><br></pre></td></tr></table></figure>
<h6 id="圆形区域检索-2">2圆形区域检索</h6>
<p><a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">searchNearby方法</a>提供圆形区域检索服务。您可以在某个地点附近进行搜索，也可以在某一个特定结果点周围进行搜索。
下面示例展示如何在前门附近搜索小吃：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);         </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);      </span><br><span class="line"><span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map,   </span><br><span class="line">              &#123; <span class="attr">renderOptions</span>:&#123;<span class="attr">map</span>: map, <span class="attr">autoViewport</span>: <span class="literal">true</span>&#125;&#125;);      </span><br><span class="line">local.<span class="title function_">searchNearby</span>(<span class="string">&quot;小吃&quot;</span>, <span class="string">&quot;前门&quot;</span>);   </span><br></pre></td></tr></table></figure>
<h6 id="矩形区域检索">3矩形区域检索</h6>
<p><a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">searchInBounds方法</a>提供矩形区域检索服务。矩形范围搜索将根据您提供的视野范围提供搜索结果。</p>
<p>注意：当搜索范围过大时可能会出现无结果的情况。</p>
<p>如下示例，展示在当前地图视野范围内搜索银行：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);        </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>);      </span><br><span class="line"><span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map,   </span><br><span class="line">              &#123; <span class="attr">renderOptions</span>:&#123;<span class="attr">map</span>: map&#125;&#125;);      </span><br><span class="line">local.<span class="title function_">searchInBounds</span>(<span class="string">&quot;银行&quot;</span>, map.<span class="title function_">getBounds</span>());   </span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//api.map.baidu.com/api?type=webgl?v=2.0&amp;ak=C3mLyfNmVlzGD4lZEpsMK0GhuxDPmQKB&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="配置搜索">3、配置搜索</h5>
<p>BMap.LocalSearch提供了<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">若干配置方法</a>，通过它们可以自定义搜索服务的行为以满足您的需求。</p>
<p>如下示例中，我们调整每页显示8个结果，并且根据结果点位置自动调整地图视野，不显示第一条结果的信息窗口：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);    </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>);  </span><br><span class="line"><span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(<span class="string">&quot;北京市&quot;</span>,   </span><br><span class="line">            &#123;<span class="attr">renderOptions</span>: &#123;<span class="attr">map</span>: map,<span class="attr">autoViewport</span>: <span class="literal">true</span>&#125;,<span class="attr">pageCapacity</span>: <span class="number">8</span>&#125;);      </span><br><span class="line">local.<span class="title function_">search</span>(<span class="string">&quot;中关村&quot;</span>);</span><br></pre></td></tr></table></figure>
<h5 id="结果面板">4、结果面板</h5>
<p>通过设置BMap.LocalSearchOptions.renderOptions.<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">panel</a>属性，可以为本地搜索对象提供一个结果列表容器，搜索结果会自动添加到容器元素中。</p>
<p>如下示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var map = new BMap.Map(&quot;container&quot;);     </span><br><span class="line">map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  </span><br><span class="line">var local = new BMap.LocalSearch(map,   </span><br><span class="line">            &#123;renderOptions: &#123;map: map,panel: &quot;results&quot;&#125;);      </span><br><span class="line">local.search(&quot;中关村&quot;);</span><br></pre></td></tr></table></figure>
<h5 id="数据接口">5、数据接口</h5>
<p>除了搜索结果会自动添加到地图和列表外，您还可以通过数据接口获得详细的数据信息，结合地图API您可以自行向地图添加标注和信息窗口。</p>
<p>BMap.<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b0">LocalSearch</a>和BMap.<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b1">LocalSearchOptions类</a>提供了若干设置回调函数的接口，通过它们可得到搜索结果的数据信息。
例如，通过onSearchComplete回调函数参数可以获得BMap.LocalResult对象实例，它包含了每一次搜索结果的数据信息。
当回调函数被执行时，您可以使用BMap.LocalSearch.getStatus()方法来确认搜索是否成功或者得到错误的详细信息。</p>
<p>在下面这个示例中，通过<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_reference_3_0.html#a7b1">onSearchComplete</a>回调函数得到第一页每条结果的标题和地址信息，并输出到页面上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>);          </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);      </span><br><span class="line"><span class="keyword">var</span> options = &#123;      </span><br><span class="line">    <span class="attr">onSearchComplete</span>: <span class="keyword">function</span>(<span class="params">results</span>)&#123;      </span><br><span class="line">        <span class="keyword">if</span> (local.<span class="title function_">getStatus</span>() == <span class="variable constant_">BMAP_STATUS_SUCCESS</span>)&#123;      </span><br><span class="line">            <span class="comment">// 判断状态是否正确      </span></span><br><span class="line">            <span class="keyword">var</span> s = [];      </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; results.<span class="title function_">getCurrentNumPois</span>(); i ++)&#123;      </span><br><span class="line">                s.<span class="title function_">push</span>(results.<span class="title function_">getPoi</span>(i).<span class="property">title</span> + <span class="string">&quot;, &quot;</span> + results.<span class="title function_">getPoi</span>(i).<span class="property">address</span>);      </span><br><span class="line">            &#125;      </span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;log&quot;</span>).<span class="property">innerHTML</span> = s.<span class="title function_">join</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>);      </span><br><span class="line">        &#125;      </span><br><span class="line">    &#125;      </span><br><span class="line"> &#125;;      </span><br><span class="line"><span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map, options);      </span><br><span class="line">local.<span class="title function_">search</span>(<span class="string">&quot;公园&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>需要单独定义一个id为log的div标签</p>
<h4 id="逆地址解析">12、逆/地址解析</h4>
<p>地址解析服务提供从地址转换到经纬度的服务，反之，逆地址解析则提供从经纬度坐标转换到地址的转换功能。</p>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2qiz6y3gcj20ak01nweh.jpg"
alt="geocoding.png" />
<figcaption aria-hidden="true">geocoding.png</figcaption>
</figure>
<h5 id="提供的转换类">1、提供的转换类</h5>
<p>Geocoder：逆/地址解析，用于坐标与地址间的相互转换。详情见<a
target="_blank" rel="noopener" href="http://mapopen-pub-jsapi.bj.bcebos.com/jsapi/reference/jsapi_reference.html#a7b27">类参考</a></p>
<h5 id="地址解析服务">2、地址解析服务</h5>
<p>根据地址描述获得坐标信息。</p>
<p>百度地图API提供Geocoder类进行地址解析，您可以通过Geocoder.getPoint()方法来将一段地址描述转换为一个坐标。</p>
<p>如下示例，我们将地址“北京市海淀区上地10街10号”转换获取该位置的地理经纬度坐标，并在这个位置上添加一个标注。注意：在调用Geocoder.getPoint()方法时您需要提供地址解析所在的城市（本例为“北京市”）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;l-map&quot;</span>);      </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">11</span>);      </span><br><span class="line"><span class="comment">// 创建地址解析器实例     </span></span><br><span class="line"><span class="keyword">var</span> myGeo = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Geocoder</span>();      </span><br><span class="line"><span class="comment">// 将地址解析结果显示在地图上，并调整地图视野    </span></span><br><span class="line">myGeo.<span class="title function_">getPoint</span>(<span class="string">&quot;北京市海淀区上地10街10号&quot;</span>, <span class="keyword">function</span>(<span class="params">point</span>)&#123;      </span><br><span class="line">    <span class="keyword">if</span> (point) &#123;      </span><br><span class="line">        map.<span class="title function_">centerAndZoom</span>(point, <span class="number">16</span>);      </span><br><span class="line">        map.<span class="title function_">addOverlay</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(point));      </span><br><span class="line">    &#125;      </span><br><span class="line"> &#125;, </span><br><span class="line"><span class="string">&quot;北京市&quot;</span>);</span><br></pre></td></tr></table></figure>
<h5 id="逆地址解析服务">3、逆地址解析服务</h5>
<p>根据坐标点获得该地点的地址描述，是地址解析的逆向转换。</p>
<p>您可以通过Geocoder.getLocation()方法获得地址描述。当解析工作完成后，您提供的回调函数将会被触发。如果解析成功，则回调函数的参数为GeocoderResult对象，否则为null。
在构造Geocoder对象时，可以增加参数{extensions_town:
true}来获得乡镇级数据，仅限国内。</p>
<h6 id="指定经纬度获取地址">1指定经纬度获取地址</h6>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var map = new BMap.Map(&quot;l-map&quot;);      </span><br><span class="line">map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);      </span><br><span class="line">// 创建地理编码实例, 并配置参数获取乡镇级数据</span><br><span class="line">var myGeo = new BMap.Geocoder(&#123;extensions_town: true&#125;);      </span><br><span class="line">// 根据坐标得到地址描述    </span><br><span class="line">myGeo.getLocation(new BMap.Point(116.364, 39.993), function(result)&#123;      </span><br><span class="line">    if (result)&#123;      </span><br><span class="line">    alert(result.address);      </span><br><span class="line">    &#125;      </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h6 id="鼠标点击地图获取地址">2鼠标点击地图获取地址</h6>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.331398</span>,<span class="number">39.897445</span>);</span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point,<span class="number">12</span>);</span><br><span class="line"><span class="keyword">var</span> geoc = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Geocoder</span>();    </span><br><span class="line">map.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>)&#123;        </span><br><span class="line">    <span class="keyword">var</span> pt = e.<span class="property">point</span>;</span><br><span class="line">    geoc.<span class="title function_">getLocation</span>(pt, <span class="keyword">function</span>(<span class="params">rs</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> addComp = rs.<span class="property">addressComponents</span>;</span><br><span class="line">        <span class="title function_">alert</span>(addComp.<span class="property">province</span> + <span class="string">&quot;, &quot;</span> + addComp.<span class="property">city</span> + <span class="string">&quot;, &quot;</span> + addComp.<span class="property">district</span> + <span class="string">&quot;, &quot;</span> + addComp.<span class="property">street</span> + <span class="string">&quot;, &quot;</span> + addComp.<span class="property">streetNumber</span>);</span><br><span class="line">    &#125;);        </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="出行路线规划">13、出行路线规划</h4>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2qjxv3qzxj20fc0d5mz2.jpg"
alt="image-20220530171950351" />
<figcaption aria-hidden="true">image-20220530171950351</figcaption>
</figure>
<p>百度地图JavaScript API
v3.0提供了驾车、公交、步行和骑行四种出行方式的路线规划功能。开发者在使用线路规划的接口时，可以使用我们提供的默认展示效果。也可以通过监听事件回调，使用检索数据完成自己的需求。v3.0的线路规划服务和v2.0的相比，在功能上有所差异。详细请参考本文档和<a
target="_blank" rel="noopener" href="https://mapopen-pub-jsapi.bj.bcebos.com/jsapi/reference/jsapi_reference_3_0.html">JavaScript
API v3.0类参考</a>。</p>
<p>提供的路线规划方式</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;">路线规划方式</th>
<th style="text-align: center;">类名</th>
<th style="text-align: center;">简介</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">驾车</td>
<td style="text-align: center;">DrivingRoute</td>
<td style="text-align: center;">提供驾车路线规划服务</td>
</tr>
<tr>
<td style="text-align: center;">公交</td>
<td style="text-align: center;">TransitRoute</td>
<td
style="text-align: center;">提供市内公交和跨城交通方式（飞机、火车、大巴）的路线规划服务</td>
</tr>
<tr>
<td style="text-align: center;">步行</td>
<td style="text-align: center;">WalkingRoute</td>
<td style="text-align: center;">提供步行路线规划服务</td>
</tr>
<tr>
<td style="text-align: center;">骑行</td>
<td style="text-align: center;">RidingRoute</td>
<td style="text-align: center;">提供骑行线路规划服务</td>
</tr>
</tbody>
</table>
<h5 id="驾车路线规划">1、驾车路线规划</h5>
<h6 id="基础驾车路线规划服务示例">1基础驾车路线规划服务示例：</h6>
<p>代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> driving = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">DrivingRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123; </span><br><span class="line">        <span class="attr">map</span>: map, </span><br><span class="line">        <span class="attr">autoViewport</span>: <span class="literal">true</span> </span><br><span class="line">&#125; </span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.486419</span>, <span class="number">39.877282</span>);</span><br><span class="line">driving.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h6 id="数据接口-1">2数据接口</h6>
<p>驾车导航服务也提供了丰富的数据接口，通过onSearchComplete回调函数可以得到BMap.DrivingRouteResult对象，它包含了驾车导航结果数据信息。
结果会包含若干驾车方案，每条方案中包含了若干驾车线路。
每条驾车线路又会包含一系列的关键步骤（BMap.Step），关键步骤描述了具体驾车行驶方案。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> options = &#123; </span><br><span class="line">    <span class="attr">onSearchComplete</span>: <span class="keyword">function</span>(<span class="params">results</span>)&#123; </span><br><span class="line">        <span class="keyword">if</span> (driving.<span class="title function_">getStatus</span>() == <span class="variable constant_">BMAP_STATUS_SUCCESS</span>)&#123; </span><br><span class="line">            <span class="comment">// 获取第一条方案 </span></span><br><span class="line">            <span class="keyword">var</span> plan = results.<span class="title function_">getPlan</span>(<span class="number">0</span>); </span><br><span class="line">            <span class="comment">// 获取方案的驾车线路 </span></span><br><span class="line">            <span class="keyword">var</span> route = plan.<span class="title function_">getRoute</span>(<span class="number">0</span>); </span><br><span class="line">            <span class="comment">// 获取每个关键步骤，并输出到页面 </span></span><br><span class="line">            <span class="keyword">var</span> s = []; </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; route.<span class="title function_">getNumSteps</span>(); i ++) &#123; </span><br><span class="line">                <span class="keyword">var</span> step = route.<span class="title function_">getStep</span>(i); </span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(step); </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">var</span> driving = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">DrivingRoute</span>(map, options);</span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.486419</span>, <span class="number">39.877282</span>);</span><br><span class="line">driving.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h5 id="公交路线规划">2、公交路线规划</h5>
<p>BMap.TransitRoute类提供公交线路规划服务。</p>
<p>注意：v3.0中，新增了TransitRoutePlan.getTotal 和
TransitRoutePlan.getTotalType方法，可以获取一条公交换乘方案中总路段数（步行+公交），和指定路段的交通方式类型（步行或公交）。</p>
<h6 id="使用服务示例">1使用服务示例</h6>
<p>代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> transit = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">TransitRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123; </span><br><span class="line">        <span class="attr">map</span>: map, </span><br><span class="line">        <span class="attr">autoViewport</span>: <span class="literal">true</span> </span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.486419</span>, <span class="number">39.877282</span>);</span><br><span class="line">transit.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h6 id="进行跨城路线规划">2进行跨城路线规划</h6>
<p>代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> transit = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">TransitRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123; </span><br><span class="line">        <span class="attr">map</span>: map, </span><br><span class="line">        <span class="attr">autoViewport</span>: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置跨城公交的换成策略为优先出发早</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">intercityPolicy</span>: <span class="variable constant_">BMAP_INTERCITY_POLICY_EARLY_START</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置跨城公交的交通方式策略为飞机优先</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">transitTypePolicy</span>: <span class="variable constant_">BMAP_TRANSIT_TYPE_POLICY_AIRPLANE</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">121.490546</span>, <span class="number">31.233585</span>);</span><br><span class="line">transit.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h6 id="结果面板-1">3结果面板</h6>
<p>您可以提供用于展示文字结果的容器元素，方案结果会自动在页面中展现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> transit = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">TransitRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123;<span class="attr">map</span>: map, <span class="attr">panel</span>: <span class="string">&quot;results&quot;</span>&#125; </span><br><span class="line">&#125;); </span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">121.490546</span>, <span class="number">31.233585</span>);</span><br><span class="line">transit.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h6 id="数据接口-2">4数据接口</h6>
<p>您可通过数据接口获取详细的公交方案信息。公交导航搜索结果用BMap.TransitRouteResult来表示，其中包含了若干公交出行方案（BMap.TransitRoutePlan）。每条出行方案由步行线路和公交线路组成。
在起点到上车点之间、下车点到终点之间以及每个换乘站之间都会存在步行线路，如果上述的某两点位置重合，那么其间的步行路线长度为0。
如下示例，通过数据接口将第一条方案的路线添加到地图上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">12</span>); </span><br><span class="line"><span class="keyword">var</span> transit = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">TransitRoute</span>(); </span><br><span class="line">transit.<span class="title function_">setSearchCompleteCallback</span>(<span class="keyword">function</span>(<span class="params">results</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (transit.<span class="title function_">getStatus</span>() == <span class="variable constant_">BMAP_STATUS_SUCCESS</span>) &#123; </span><br><span class="line">        <span class="keyword">var</span> firstPlan = results.<span class="title function_">getPlan</span>(<span class="number">0</span>); </span><br><span class="line">        <span class="comment">// 绘制步行线路 </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; firstPlan.<span class="title function_">getNumRoutes</span>(); i++) &#123; </span><br><span class="line">            <span class="keyword">var</span> walk = firstPlan.<span class="title function_">getRoute</span>(i); </span><br><span class="line">            <span class="keyword">if</span> (walk.<span class="title function_">getDistance</span>(<span class="literal">false</span>) &gt; <span class="number">0</span>)&#123; </span><br><span class="line">                <span class="comment">// 步行线路有可能为0 </span></span><br><span class="line">                map.<span class="title function_">addOverlay</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Polyline</span>(walk.<span class="title function_">getPoints</span>(), &#123;<span class="attr">lineColor</span>: <span class="string">&quot;green&quot;</span>&#125;)); </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// 绘制公交线路 </span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; firstPlan.<span class="title function_">getNumLines</span>(); i++) &#123; </span><br><span class="line">                <span class="keyword">var</span> line = firstPlan.<span class="title function_">getLine</span>(i); </span><br><span class="line">                map.<span class="title function_">addOverlay</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Polyline</span>(line.<span class="title function_">getPoints</span>())); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">121.490546</span>, <span class="number">31.233585</span>);</span><br><span class="line">transit.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h5 id="步行路线规划">3、步行路线规划</h5>
<p>BMap.WalkingRoute提供步行线路规划服务。基本用法和驾车线路规划类似。</p>
<h6 id="使用服务示例-1">1使用服务示例</h6>
<p>代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line">    <span class="keyword">var</span> walk = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">WalkingRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123;<span class="attr">map</span>: map&#125; </span><br><span class="line">&#125;); </span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.486419</span>, <span class="number">39.877282</span>);</span><br><span class="line">walk.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<h5 id="骑行线路规划">4、骑行线路规划</h5>
<p>BMap.RidingRoute提供骑行线路规划服务，基本用法和步行线路规划基本相同。</p>
<h6 id="使用服务示例-2">1使用服务示例</h6>
<p>代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;container&quot;</span>); </span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.404</span>, <span class="number">39.915</span>), <span class="number">14</span>); </span><br><span class="line"><span class="keyword">var</span> riding = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">RidingRoute</span>(map, &#123; </span><br><span class="line">    <span class="attr">renderOptions</span>: &#123;<span class="attr">map</span>: map&#125; </span><br><span class="line">&#125;); </span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.310791</span>, <span class="number">40.003419</span>);</span><br><span class="line"><span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.486419</span>, <span class="number">39.877282</span>);</span><br><span class="line">riding.<span class="title function_">search</span>(start, end);</span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2qk9n6xz2j21400q20wv.jpg"
alt="image-20220530173113074" />
<figcaption aria-hidden="true">image-20220530173113074</figcaption>
</figure>
<h4 id="定位">14、定位</h4>
<p>JavaScript
API提供在Web端获取当前位置信息的方法，融合了浏览器定位、IP定位、安卓定位SDK辅助定位等多种手段，提供了获取当前准确位置、获取当前城市信息等功能。</p>
<p>浏览器定位精度依赖浏览器自身特性，IP定位的精度值为城市级别。</p>
<p>对于安卓WebView页面的开发者，可以结合定位SDK进行辅助定位，使用方法参见<a
target="_blank" rel="noopener" href="http://lbsyun.baidu.com/index.php?title=android-locsdk/guide/addition-func/assistant-h5">定位SDK相关章节</a>。</p>
<p>注意：</p>
<ol type="1">
<li>请求JavaScript API v3.0的定位功能时，必须获取用户授权。</li>
<li>由于Chrome、iOS10等已不再支持非安全域的浏览器定位请求，为保证定位成功率和精度，请尽快升级您的站点到HTTPS。</li>
<li>iOS15系统下浏览器默认关闭位置请求，需要用户设置为允许/询问后方可获取精确的定位。</li>
</ol>
<p>提供的定位服务</p>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 12%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr>
<th><strong>接口</strong></th>
<th><strong>类名</strong></th>
<th><strong>简介</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>浏览器定位</td>
<td>Geolocation</td>
<td>优先调用浏览器H5定位接口，如果失败会调用IP定位</td>
</tr>
<tr>
<td>IP定位</td>
<td>LocalCity</td>
<td>根据用户IP 返回城市级别的定位结果</td>
</tr>
<tr>
<td>定位SDK辅助定位</td>
<td>Geolocation</td>
<td>当您的APP中有内置的Web页面，同时在Web页面需要提供您的当前位置信息时，可调用集成在App中的百度地图定位SDK来获取更精准的位置信息</td>
</tr>
</tbody>
</table>
<p>定位方法代码示例</p>
<h5 id="浏览器定位">1、浏览器定位</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.331398</span>,<span class="number">39.897445</span>);</span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point,<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> geolocation = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Geolocation</span>();</span><br><span class="line">geolocation.<span class="title function_">getCurrentPosition</span>(<span class="keyword">function</span>(<span class="params">r</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">getStatus</span>() == <span class="variable constant_">BMAP_STATUS_SUCCESS</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> mk = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(r.<span class="property">point</span>);</span><br><span class="line">		map.<span class="title function_">addOverlay</span>(mk);</span><br><span class="line">		map.<span class="title function_">panTo</span>(r.<span class="property">point</span>);</span><br><span class="line">		<span class="title function_">alert</span>(<span class="string">&#x27;您的位置：&#x27;</span>+r.<span class="property">point</span>.<span class="property">lng</span>+<span class="string">&#x27;,&#x27;</span>+r.<span class="property">point</span>.<span class="property">lat</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="title function_">alert</span>(<span class="string">&#x27;failed&#x27;</span>+<span class="variable language_">this</span>.<span class="title function_">getStatus</span>());</span><br><span class="line">	&#125;        </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="ip定位">2、IP定位</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.331398</span>,<span class="number">39.897445</span>);</span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point,<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myFun</span>(<span class="params">result</span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> cityName = result.<span class="property">name</span>;</span><br><span class="line">	map.<span class="title function_">setCenter</span>(cityName);</span><br><span class="line">	<span class="title function_">alert</span>(<span class="string">&quot;当前定位城市:&quot;</span>+cityName);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myCity = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalCity</span>();</span><br><span class="line">myCity.<span class="title function_">get</span>(myFun); </span><br></pre></td></tr></table></figure>
<h5 id="定位sdk辅助定位">3、定位SDK辅助定位</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;allmap&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="number">116.331398</span>,<span class="number">39.897445</span>);</span><br><span class="line">map.<span class="title function_">centerAndZoom</span>(point,<span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> geolocation = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Geolocation</span>();</span><br><span class="line"><span class="comment">// 开启SDK辅助定位</span></span><br><span class="line">geolocation.<span class="title function_">enableSDKLocation</span>();</span><br><span class="line">geolocation.<span class="title function_">getCurrentPosition</span>(<span class="keyword">function</span>(<span class="params">r</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">getStatus</span>() == <span class="variable constant_">BMAP_STATUS_SUCCESS</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> mk = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(r.<span class="property">point</span>);</span><br><span class="line">		map.<span class="title function_">addOverlay</span>(mk);</span><br><span class="line">		map.<span class="title function_">panTo</span>(r.<span class="property">point</span>);</span><br><span class="line">		<span class="title function_">alert</span>(<span class="string">&#x27;您的位置：&#x27;</span>+r.<span class="property">point</span>.<span class="property">lng</span>+<span class="string">&#x27;,&#x27;</span>+r.<span class="property">point</span>.<span class="property">lat</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="title function_">alert</span>(<span class="string">&#x27;failed&#x27;</span>+<span class="variable language_">this</span>.<span class="title function_">getStatus</span>());</span><br><span class="line">	&#125;        </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="鼠标绘制">15、鼠标绘制</h4>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2rllg7cgbj21bj0drdl8.jpg"
alt="image-20220531150242144" />
<figcaption aria-hidden="true">image-20220531150242144</figcaption>
</figure>
<h5 id="提供的鼠标绘制工具">1、提供的鼠标绘制工具</h5>
<p>DrawingManager：鼠标绘制工具。通过此工具用户可以在地图任意位置上画点、画线、画面并显示线的距离及面的面积。详情可见<a
target="_blank" rel="noopener" href="https://lbs.baidu.com/index.php?title=jspopular3.0/openlibrary">开源库</a>。</p>
<h5 id="鼠标绘制过程">2、鼠标绘制过程</h5>
<h6
id="在页面的头部应用鼠标绘制工具开源库的文件">1在页面的头部应用鼠标绘制工具开源库的文件</h6>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h6 id="在代码中实例化鼠标绘制工具">2在代码中实例化鼠标绘制工具</h6>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> styleOptions = &#123;</span><br><span class="line">    <span class="attr">strokeColor</span>:<span class="string">&quot;red&quot;</span>,    <span class="comment">//边线颜色。</span></span><br><span class="line">    <span class="attr">fillColor</span>:<span class="string">&quot;red&quot;</span>,      <span class="comment">//填充颜色。当参数为空时，圆形将没有填充效果。</span></span><br><span class="line">    <span class="attr">strokeWeight</span>: <span class="number">3</span>,       <span class="comment">//边线的宽度，以像素为单位。</span></span><br><span class="line">    <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,    <span class="comment">//边线透明度，取值范围0 - 1。</span></span><br><span class="line">    <span class="attr">fillOpacity</span>: <span class="number">0.6</span>,      <span class="comment">//填充的透明度，取值范围0 - 1。</span></span><br><span class="line">    <span class="attr">strokeStyle</span>: <span class="string">&#x27;solid&#x27;</span> <span class="comment">//边线的样式，solid或dashed。</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//实例化鼠标绘制工具</span></span><br><span class="line"><span class="keyword">var</span> drawingManager = <span class="keyword">new</span> <span class="title class_">BMapLib</span>.<span class="title class_">DrawingManager</span>(map, &#123;</span><br><span class="line">    <span class="attr">isOpen</span>: <span class="literal">false</span>, <span class="comment">//是否开启绘制模式</span></span><br><span class="line">    <span class="attr">enableDrawingTool</span>: <span class="literal">true</span>, <span class="comment">//是否显示工具栏</span></span><br><span class="line">    <span class="attr">drawingToolOptions</span>: &#123;</span><br><span class="line">        <span class="attr">anchor</span>: <span class="variable constant_">BMAP_ANCHOR_TOP_RIGHT</span>, <span class="comment">//位置</span></span><br><span class="line">        <span class="attr">offset</span>: <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Size</span>(<span class="number">5</span>, <span class="number">5</span>), <span class="comment">//偏离值</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">circleOptions</span>: styleOptions, <span class="comment">//圆的样式</span></span><br><span class="line">    <span class="attr">polylineOptions</span>: styleOptions, <span class="comment">//线的样式</span></span><br><span class="line">    <span class="attr">polygonOptions</span>: styleOptions, <span class="comment">//多边形的样式</span></span><br><span class="line">    <span class="attr">rectangleOptions</span>: styleOptions <span class="comment">//矩形的样式</span></span><br><span class="line">&#125;);  </span><br></pre></td></tr></table></figure>
<h4 id="点聚合">16、点聚合</h4>
<blockquote>
<p>您常常需要在地图上展示非常多的点。当地图可视范围内的点越多，点与点的图标堆叠、覆盖的效果就会越严重。为了保证展示效果，本节介绍如何使用点聚合功能，聚合区域内的点，使得可以自适应地图的比例尺进行数据展示。</p>
</blockquote>
<figure>
<img
src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2rlofokrmj20pw0a6q48.jpg"
alt="image-20220531150530432" />
<figcaption aria-hidden="true">image-20220531150530432</figcaption>
</figure>
<h5 id="提供的点聚合工具">1、提供的点聚合工具</h5>
<p>MarkerClusterer：多标注聚合器。此工具解决加载大量点要素到地图上造成缓慢，且产生覆盖现象的问题。详情可见<a
target="_blank" rel="noopener" href="https://lbs.baidu.com/index.php?title=jspopular3.0/openlibrary">开源库</a>。</p>
<h5 id="点聚合过程">2、点聚合过程</h5>
<h5
id="在页面的头部应用点聚合工具开源库的文件">1在页面的头部应用点聚合工具开源库的文件</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5
id="在代码中添加marker实例化点聚合">2在代码中添加Marker，实例化点聚合</h5>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">MAX</span> = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> markers = [];</span><br><span class="line"><span class="keyword">var</span> pt = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (; i &lt; <span class="variable constant_">MAX</span>; i++) &#123;</span><br><span class="line">    pt = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Point</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">40</span> + <span class="number">85</span>, <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">30</span> + <span class="number">21</span>);</span><br><span class="line">    markers.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(pt));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最简单的用法，生成一个marker数组，然后调用markerClusterer类即可。</span></span><br><span class="line"><span class="keyword">var</span> markerClusterer = <span class="keyword">new</span> <span class="title class_">BMapLib</span>.<span class="title class_">MarkerClusterer</span>(map, &#123;<span class="attr">markers</span>:markers&#125;);</span><br></pre></td></tr></table></figure>
<h4
id="百度地图开放平台-示例中心httpslbsyun.baidu.comjsdemo.htmacreatemap">百度地图开放平台-示例中心：https://lbsyun.baidu.com/jsdemo.htm#aCreateMap</h4>

      </div>
    </div>
    
      <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script>
      <script>
        if (window.mermaid) {
          mermaid.initialize({"startOnload":true});
        }
      </script>
    
  </article>
  <div class="post__foot">
    
      <div class="like-author">
  <input type="checkbox" id="likeCode" />
  <div class="author-face">
    <img height="100px"
         width="100px"
         id="front-face"
         alt="author face"
         src="/images/author-face.jpg" />
    <img height="100px"
         width="100px"
         id="back-face"
         alt="like code"
         src="/images/pay-code.jpg" />
  </div>
  <div class="like-text">“给作者倒杯卡布奇诺”</div>
  <label for="likeCode" class="like-btn">
    <svg viewBox="0 0 1024 1024"
         width="20px"
         style="margin-right: 10px"
         height="20px">
      <path d="M466.88 908.96L113.824 563.296a270.08 270.08 0 0 1 0-387.392c108.8-106.56 284.896-106.56 393.696 0 1.504 1.472 2.976 2.944 4.448 4.48 1.472-1.536 2.944-3.008 4.448-4.48 108.8-106.56 284.896-106.56 393.696 0a269.952 269.952 0 0 1 34.016 347.072l-387.392 385.6a64 64 0 0 1-89.92 0.384z" p-id="13650" fill="#ee4242" />
    </svg>
    喜欢作者
  </label>
</div>

    
    <div class="post-nav">
  
    <a class="post-nav-item-left" href="/2022/05/31/5%E6%9C%88%E5%BA%95%E6%9C%80%E5%90%8E%E4%B8%80%E5%91%A8%E6%80%BB%E7%BB%93/">
      <div class="text-align">
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
        <span class="text-small">上一篇</span>
      </div>
      <div>五月底最后一周总结</div>
    </a>
  
  <div class="vhr"></div>
  
    <a class="post-nav-item-right" href="/2022/05/30/%E7%BC%98%E8%8B%91%E5%9B%AD%E7%AC%AC61%E6%9C%9F/">
      <div class="text-align">
        <span class="text-small">下一篇</span>
        <svg t="1670570876164"
             class="icon"
             viewBox="0 0 1024 1024"
             transform="scale(-1,-1)"
             width="16"
             height="16">
          <path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596" />
        </svg>
      </div>
      抬头收获缘于低头耕耘
    </a>
  
</div>

    
    
  </div>

    </div>
    <div class="foot">
  <div class="foot-inner">
    <div class="foot__head">
      
        <div class="foot-line">
          <div class="matts">今</div><div class="matts">夜</div><div class="matts">无</div><div class="matts">眠</div>
        </div>
      
        <div class="foot-line">
          <div class="matts">睡</div><div class="matts">意</div><div class="matts">全</div><div class="matts">无</div>
        </div>
      
    </div>
    <div class="foot__body">
      
        <div class="foot-item">
          <div class="foot-item__head">朋友</div>
          <div class="foot-item__body">
            
            


  
  
    <div class="foot-link-group">
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/icon/icon-link.svg" />
            <a class="foot-link" target="_blank" rel="noopener" href="https://moyanxinxu.github.io/unlock-hf/">unlock-hf</a>
          </div>
        
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/icon/icon-link+.svg" />
            <a class="foot-link" href="mailto:873101411@qq.com?subject=申请http://example.com的友链">申请友链</a>
          </div>
        
      
        
        
      
        
        
      
    </div>
  


          </div>
        </div>
      
      
        <div class="foot-item">
          <div class="foot-item__head">账号</div>
          <div class="foot-item__body">
            


  
  
    <div class="foot-link-group">
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/logo-github.svg" />
            <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/viserion-nlper">viserion-nlper</a>
          </div>
        
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/logo-wx.svg" />
            <a class="foot-link" target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Fq9ZIUwZvMNx2kSahz8zEw">HanLP.com</a>
          </div>
        
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/logo-zh.svg" />
            <a class="foot-link" target="_blank" rel="noopener" href="https://www.zhihu.com/people/shuo-hao-jin-ye-bu-dian-yan">Mundooo</a>
          </div>
        
      
        
        
      
    </div>
  


          </div>
        </div>
      
      <div class="foot-item">
        <div class="foot-item__head">联系</div>
        <div class="foot-item__body">
          


  
  
    <div class="foot-link-group">
      
        
        
          <div class="text">
            <img alt="link"
                 height="20px"
                 width="20px"
                 src="/images/icon/icon-email.svg" />
            <a class="foot-link" href="mailto:name@example.com">name@example.com</a>
          </div>
        
      
        
        
      
        
        
      
        
        
      
    </div>
  


        </div>
      </div>
    </div>
    <div class="copyright">
      <a href="http://example.com">思想放牧之地</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp;
      <svg width="20" height="20" viewBox="0 0 725 725">
        <path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z" />
        <path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z" />
        <path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z" />
      </svg>
      <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动
    </div>
  </div>
</div>

    
    
      <script src="/js/search.js"></script>
      <script>searchInitialize("/search.json")</script>
    
    <script src="/js/copy-code.js"></script>
    
  

  </body>
</html>
